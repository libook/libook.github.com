var DJ=(function(c){function b(g){var e=0;for(var f=0;f<g.length;f++){if(g.charCodeAt(f)>255){e+=2}else{e++}}return e}function d(j,f){var k=0;var h=[];for(var g=0,e=j.length;g<e;g++){if(k>f-1){break}if(j.charCodeAt(g)>255){h.push(j.charAt(g));k+=2}else{h.push(j.charAt(g));k++}}return h.join("")}function a(n,j){var n=n.replace(/\>\s+\</gi,"><");var p=/\<[^>]+\>[^<]*/gi;var g=/\<[^>]+\>/gi;var r=n.replace(g,"");var e=n.match(p);var h;var k;var l="";var s=[];if(b(r)<j){return{html:n,cut:false}}else{var m=j;var q;var o;if(e){for(h=0,k=e.length;h<k;h++){q=e[h].replace(g,"");o=(q=="")?0:b(q);if(o<m){s.push(e[h]);m-=o}else{s.push(e[h].replace(new RegExp("("+q+")","gi"),d(q,m)));break}}l=f(s.join(""))}else{l=d(n,j)}return{html:l,cut:true}}function f(w){var v=/<\s*(\w+\b)(?:[^>]*[^\/])?>|<(\/\w+)>/ig;var x=[];var t=w;w.replace(v,function(y,i,A){var z=(i==""||typeof i=="undefined")?((A==""||typeof A=="undefined")?"":A):i;if(z.charAt(0)=="/"){if(x.length>0&&x[x.length-1]==z.substring(1)){x.pop()}}else{if(z!="br"&&z!="hr"&&z!="input"){x.push(z)}}});for(var u=x.length-1;u>-1;u--){t+="</"+x[u]+">"}return t}}return{namespace:function(g){if(!g||!g.length){return null}var h=g.split(".");var e=DJ;for(var f=(h[0]=="DJ")?1:0;f<h.length;f++){e[h[f]]=e[h[f]]||{};e=e[h[f]]}return e},fixStr:function(h,f,g){var e;if(!g){g="..."}if(b(h)>f){e=d(h,f)+g}else{e=h}return e},getByteLen:function(e){return b(e)},cutHtml:function(f,e){return a(f,e)},formatNum:function(f){if(f.length>0){for(var e=0;e<f.length;e++){if(f.charAt(e)!="0"){realVal=f.substring(e);break}else{realVal=f}}}return realVal},window:{closeAlert:null,alertCount:3,alert:function(j,g,i){var e,h=this;switch(g){case"ok":e="newalert-true";break;case"error":e="newalert-false";break;case"warn":e="newalert-warning";break;case"warm":e="newalert-warning";break;default:e="newalert-true"}var f=['<div id="zmAlert" class="newalert '+e+'">','<div class="alert-ico png"></div>','<a class="alertclose"></a>','<div class="container yahei">','<div class="tipscountdown"><span class="count">3</span>秒后隐藏</div>',j,"</div>","</div>"].join("");h.alertCount=3;if(h.closeAlert){clearInterval(h.closeAlert)}if(c("#zmAlert").size()>0){c("#zmAlert").remove();c("body").append(f)}else{c("body").append(f)}c("#zmAlert").stop(true,true).slideDown(300);h.closeAlert=setInterval(k,1000);c("#zmAlert").die().live("mouseenter",function(){clearInterval(h.closeAlert)});c("#zmAlert").live("mouseleave",function(){h.closeAlert=setInterval(k,1000)});c("#zmAlert .alertclose").live("click",function(){c("#zmAlert").stop(true,false).slideUp(300,function(){if(i){i()}})});function k(){if(h.alertCount<1){clearInterval(h.closeAlert);c("#zmAlert").stop(true,false).slideUp(300,function(){if(i){i()}})}else{c("#zmAlert .count").text(h.alertCount)}h.alertCount--}},confirm:function(h,k,g,j,o){if(c("p.btcontainer").length==1){return}var n,l,i="";n=parseInt(h.offset().left)+parseInt(h.width()/2)-120;l=parseInt(h.offset().top)+h.height();var m="",f="";if(o){m='style="display:none;"';f='style="background:none;padding-left:0;"'}if(j=="up"){l=parseInt(h.offset().top)+h.height();i="altconfirmup"}else{l=parseInt(h.offset().top)-131}var e=['<div style="height:0;" class="confirmclass">','<div class="altdiv '+i+'">','<p style="text-align:center;height:44px;padding:0 12px;"><span class="altconfirm png" '+f+">"+k+"</span></p>",'<p class="btcontainer"><a href="javascript:void(0);" class="submitbtn confirm-btn">确认</a><span '+m+'>&nbsp;</span><a href="javascript:void(0);" class="submitbtn cancel-btn" '+m+">取消</a></p>","</div>","</div>"].join("");c("body").append(e);c(".altdiv").css({top:l,left:n});c(".btcontainer .confirm-btn").click(function(){c(this).parent().parent().parent().find("shape").remove();if(g){g()}c(this).parent().parent().parent().remove()});c(".btcontainer .cancel-btn").click(function(){c(this).parent().parent().parent().find("shape").remove();c(this).parent().parent().parent().remove()})}}}})(jQuery);DJ.KEY={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40};jQuery.cookie=function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};DJ.combox=function(b,a){this.element=b;this.opts=$.extend({},DJ.combox.defaults,a);this._init()};DJ.combox.prototype={_init:function(){var h=this;var g;var c="";if(h.opts.width){g=h.opts.width}else{if(h.element.width()<h.opts.minWidth){g=h.opts.minWidth}else{g=h.element.width()}}if(!h.opts.debug){h.element.hide()}var b=["<span class='combox' style='width:"+g+"px;'><input class='comboxText' style='width:"+(g-37)+"px' readonly='readonly' type='text' value=''/>","<span class='comboxArrow'></span>","<input class='comboxValue' type='hidden' value='' /></span>"].join("");$(b).insertAfter(h.element);if(!h.opts.pleaseSelect==""){h.element.next().find(".comboxText").eq(0).val(h.opts.pleaseSelect)}var d=h.element.find("option");var a="",f="";for(var e=0;e<d.length;e++){if(d.eq(e).val()!=""){if(d.eq(e).attr("manage")==2){a+=("<li class='group' comboxVal ='"+d.eq(e).val()+"' default='"+d.eq(e).text()+"'>"+DJ.fixStr(d.eq(e).text(),18,"...")+"</li>")}else{a+=("<li comboxVal ='"+d.eq(e).val()+"' default='"+d.eq(e).text()+"'>"+DJ.fixStr(d.eq(e).text(),18,"...")+"</li>")}}}if(h.opts.addList){c="<div class='comboxAdd'><span class='innerborder'><input class='deftest' type='text/css' value='' size='10' maxlength='"+(h.opts.maxlength==undefined?"20":""+h.opts.maxlength)+"'/></span> <input class='addsort' type='button' value='添加新图格'/></div>"}f="<div class='pannel' style='width:"+g+"px'><ul style='width:"+g+"px'>"+a+"</ul>"+c+"</div>";h.element.next().append(f);$(".pannel li").each(function(){$(this).bind("mouseover",function(){$(this).removeClass("out");$(this).addClass("over")});$(this).bind("mouseout",function(){$(this).addClass("out")})});if(!this.opts.isSelect){$(".combox").eq(comIdex).find(".comboxText").css({color:"#ccc"})}h.element.next().find(".comboxText").eq(0).keyup(function(){if(h.opts.allowAnyValue){h.element.next().find(".comboxText").eq(0).removeAttr("readonly");var j=$(".comboxText").index(this);var k=$(".combox").eq(j).offset().left;var m=parseInt($(".combox").eq(j).offset().top+26);$(".pannel").eq(index).offset().left=k;$(".pannel").eq(index).offset().top=m;$(".pannel").eq(index).css({left:k});$(".pannel").eq(j).show();var l=$(this).val();var i=$(".pannel").eq(j).find("li").length;$(".pannel").eq(j).find("li").each(function(){if($(this).text().indexOf(l)!=0){$(this).hide()}else{$(this).show("slide")}})}});h.element.next().bind("click",function(q){if(h.opts.lock){return}var p=q.target;if(!($(p).attr("class")=="comboxText"||$(p).attr("class")=="comboxArrow")){return}$(".pannel").hide();q.stopPropagation();if(!h.opts.isSelect){return}var k=0;var m=$(".combox").index(this);var j=$(".combox").eq(m);var s=j.find(".pannel");var t="";var l=j.height();var o=s.find("ul li").length;o>5?k=h.opts.maxHeight:k=o*30;s.find("ul").css({height:k});s.find(".comboxAdd").css({height:"30px"});if(typeof h.opts.position=="string"&&h.opts.position=="up"){var n=$(".combox").eq(m).offset().top-$(".pannel").eq(m).find("ul").eq(0).height();$(".pannel").eq(m).css({top:n})}else{$(".pannel").eq(m).css({top:h.opts.top})}$(".combox").css({zIndex:1});$(".combox").eq(m).css({zIndex:2});$(".combox").eq(m).find(".pannel").show();var r=$(".pannel").eq(m).find("ul>li").index($(".pannel").eq(m).find("ul>li.select").eq(0))*30;$(".pannel").eq(m).find("ul").scrollTop(r);j.find("ul li").each(function(u){$(this).unbind("click").bind("click",function(){var v=$(this).text();j.find(".comboxValue").val($(this).attr("comboxVal"));j.find(".comboxText").val(v);j.find(".pannel").hide();j.find("ul>li").removeClass("select");$(this).addClass("select");setTimeout(function(){j.prev().find("option").each(function(){if($(this).text()==v){this.setAttribute("selected","selected");if(h.opts.selectCallBack){h.opts.selectCallBack($(this).attr("value"))}}else{this.removeAttribute("selected")}})},200)})});function i(u){u=u.replace(/&/g,"&amp;");u=u.replace(/</g,"&lt;");u=u.replace(/>/g,"&gt;");u=u.replace(/'/g,"&acute;");u=u.replace(/"/g,"&quot;");u=u.replace(/\|/g,"&brvbar;");return u}$(".pannel").eq(m).find(":last-child").find("input.addsort").hover(function(){$(this).addClass("addsorthover")},function(){$(this).removeClass("addsorthover")});$(".combox").eq(m).find("input.addsort").click(function(){if(h.opts.lock){return}var x=$(this).prev().find("input.deftest").val();var u=/^([a-zA-Z0-9\-_\u4e00-\u9fa5]){1,20}/;if(x==""||!u.test(x)){return}if(h.opts.addListCallBack){if(v(x)>-1){var y=v(x)*30;$(".pannel").eq(m).find("ul").scrollTop(y);j.find("ul li").each(function(z){if(z!=v(x)){return}var A=$(this).text();j.find(".comboxValue").val($(this).attr("comboxVal"));j.find(".comboxText").val(i(A));j.find(".pannel").hide();j.find("ul>li").removeClass("select");$(this).addClass("select");j.prev().find("option").each(function(){if($(this).text()==A){this.setAttribute("selected","selected")}else{this.removeAttribute("selected")}})});return}h.opts.addListCallBack(x);if(h.opts.selectCallBack){setTimeout(function(){h.opts.selectCallBack()},500)}}$(this).prev().find("input.deftest").val("");var w=j.find("ul li").length;if(w>5){j.find("ul").css({height:5*22})}function v(D){var B=j.prev().find("option");var A=-1;for(var C=0,z=B.length;C<z;C++){if(B.eq(C).text().toLowerCase()==D.toLowerCase()){A=C}}return A}})});$(document).click(function(i){if(i.target.className!="combox"){$(".pannel").hide()}})},getValue:function(a){return a.next().find(".comboxValue").eq(0).val()},setValue:function(d,b){var g=$(".combox").index(d.next());var l=$(".combox").eq(g);var c=$(".pannel").eq(g).find("ul>li"),k=0;for(var e=0,h=c.length;e<h;e++){if(c[e].getAttribute("comboxVal")==b){k=e}}var f=$(".pannel").eq(g).find("ul>li").index($(".pannel").eq(g).find("ul>li").eq(k));var j=$(".pannel").eq(g).find("ul>li").eq(f).attr("default");l.find(".comboxValue").val($(".pannel").eq(g).find("ul>li").eq(f).attr("comboxVal"));if(j==undefined){l.find(".comboxText").val(a(this.opts.pleaseSelect))}else{l.find(".comboxText").val(a(j))}l.find(".pannel>ul>li").removeClass("select");l.find(".pannel>ul>li").eq(f).addClass("select");l.prev().find("option").each(function(){if($(this).attr("value")==b){this.setAttribute("selected","selected")}else{this.removeAttribute("selected")}});function a(i){i=i.replace(/&amp;/g,"&");i=i.replace(/&lt;/g,"<");i=i.replace(/&gt;/g,">");i=i.replace(/&acute;/g,"'");i=i.replace(/&quot;/g,'"');i=i.replace(/&brvbar;/g,"|");return i}},lock:function(a){this.opts.lock=a},setAllowAnyValue:function(a){var b=this;b.opts.allowAnyValue=a},addList:function(d,c,e){var a=$(".combox").index(d.next());var f=$(".combox").eq(a);f.find("ul li").each(function(){$(this).removeClass("select")});var b="<li class='select' default='"+e+"' comboxVal='"+c+"'>"+e+"</li>";f.find("ul").append(b);f.find(".pannel").hide();f.prev().find("option").each(function(){this.removeAttribute("selected")});f.prev().append("<option selected='selected' manage='1' value='"+c+"'>"+e+"</option>");f.find(".comboxValue").val(c);$(".combox").eq(a).find(".comboxText").val(e);if(this.opts.selectCallBack){this.opts.selectCallBack()}$(".pannel li").each(function(){$(this).bind("mouseover",function(){$(this).removeClass("out");$(this).addClass("over")});$(this).bind("mouseout",function(){$(this).addClass("out")})})},removeCont:function(){this.element.html("").next().remove()},hideCombox:function(){this.element.next().hide()},showCombox:function(){this.element.next().show()}};DJ.combox.defaults={debug:true,pleaseSelect:"",allowAnyValue:false,position:"down",top:-1+"px",isSelect:true,maxHeight:150,minWidth:50,width:null,addList:false,lock:false,addListCallBack:null,selectCallBack:null};$.extend($.fn,{fnPubTips:function(){var d,g,f,b;var c,e,a="";d=$(this);if(d.attr("tipsWidth")){a="width:"+d.attr("tipsWidth")+"px"}else{a="white-space:nowrap;word-wrap:normal"}b=d.attr("msg");if(!d.attr("filterTag")){b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;")}f='<span class="tipscontent" style="'+a+'"><em class="arrow"></em>'+b+"</span>";g=['<div class="pubtips" id="pubtips">',"</div>"].join("");if($("#pubtips").size()<1){$("body").append(g)}$("#pubtips").html(f).show();c=parseInt(d.offset().left)+parseInt(d.innerWidth()/2)-parseInt($("#pubtips span").innerWidth()/2);e=parseInt(d.offset().top)-$("#pubtips .tipscontent").innerHeight()-4;$("#pubtips").css({left:c,top:e})},getbytelength:function(b){if(b==undefined||b.length<1){return 0}var c=0;for(var a=0;a<b.length;a++){if(b.charCodeAt(a)>255){c=c+1}else{c=c+0.5}}return Math.round(c)},getInputlength:function(b){var c=0;for(var a=0;a<b.length;a++){if(b.charCodeAt(a)>255){c+=2}else{c++}}return c},fngetline:function(f,g,d){var b=0;var a=g.split("\n");b=a.length;for(var c=0;c<a.length;c++){var e=$.fn.getInputlength(a[c])/d;if(e>1){if($.fn.getInputlength(a[c])%d==0){b+=parseInt(e)-1}else{b+=parseInt(e)}}}return b},countNumber:function(f,c){var e={scroll:false,flashing:false,rowsize:0,numberid:100,textareaid:null,rowheight:4,deflultheight:60,callback:null,buttonClass:"",buttonOff:"",effactOn:true};var b=c;var d=$.extend({},e,b);var h,a;var g=[d.rowheight];typeof f=="string"?h=$(f):h=f;typeof d.textareaid=="string"?a=$(d.textareaid):a=d.textareaid;h.keyup(function(p){var n=$.fn.getbytelength($.trim(h.val()));var j=$.fn.getInputlength($.trim(h.val()));var m=$.fn.fngetline(p,h.val(),d.rowsize);g.push(m);if(d.scroll){if(m>d.rowheight){if(h.height()-d.deflultheight!=(m-d.rowheight)*14){var i=(m-d.rowheight)*14;var l=i+d.deflultheight;var o=h.height();h.css({height:l});d.callback(h.height()-o)}}else{if(h.height()>d.deflultheight){var k=h.height();h.css({height:d.deflultheight+"px"});d.callback(d.deflultheight-k)}}if(n<=d.numberid){a.text(n);$(h).removeClass("bgcolor");a.css({color:"#65C5B3"})}else{a.text(n);a.css({color:"#ff6600"})}if(n==0){f.parent().next().find("a").removeClass().addClass(d.buttonOff)}else{f.parent().next().find("a").removeClass().addClass(d.buttonClass)}}else{if(n<=d.numberid){if(d.textareaid){a.text(n);a.removeClass().addClass("blue")}h.removeClass("bgcolor")}else{if(d.textareaid){a.text(n-d.numberid);a.removeClass().addClass("orangered")}if(d.effactOn){h.addClass("bgcolor").animate({opacity:"0.25"},50).animate({opacity:"1"},50).animate({opacity:"0.25"},50).animate({opacity:"1"},50)}}}});h.keyup()}});$(".xiHasTips").live("mouseenter",function(){$(this).fnPubTips()}).live("mouseleave",function(){$("#pubtips").hide()});